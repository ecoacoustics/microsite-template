+++
title = 'Can you hear a Plains Wanderer?'
draft = false
+++

<script
    type="module"
    src="https://cdn.jsdelivr.net/npm/@ecoacoustics/web-components/dist/components.js"
></script>

<sl-input
    id="auth-token-input"
    type="password"
    label="Authentication Token"
    password-toggle
></sl-input>

<oe-verification-grid id="verification-grid" grid-size="1">
    <oe-verification verified="true" shortcut="y">Yes</oe-verification>
    <oe-verification verified="false" shortcut="n">No</oe-verification>
</oe-verification-grid>
<oe-data-source for="verification-grid"></oe-data-source>

<script>
    (async () => {
        const api = await import("/js/baw-api.js");
        let bawApi = new api.BawApi("https://api.staging.ecosounds.org");

        const authElement = document.getElementById("auth-token-input");
        authElement.addEventListener("sl-change", (event) => {
            console.debug(event);
        });

        async function bootstrapVerificationGrid(target) {
            const callback = await bawApi.getEvents("Willie Wagtail");
            target.getPage = callback;
            target.urlTransformer = bawApi.createUrlTransformer();

            target.addEventListener("decision-made", (decision) => {
                handleDecision(decision);
            });
        }

        async function handleDecision(model) {
            await this.api.upsertVerification();
        }

        async function setup() {
            const verificationGrids = document.querySelectorAll(
                "oe-verification-grid"
            );
            for (const element of verificationGrids) {
                bootstrapVerificationGrid(element);
            }
        }

        await setup();
    })();
</script>
